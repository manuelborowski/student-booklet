{% import "bootstrap/wtf.html" as wtf %}
{% import "bootstrap/utils.html" as utils %}
{% extends "base.html" %}


{% block content2 %}
<div class="content-section">
    {{ utils.flashed_messages() }}
    <!-- begin message block -->
    <div class="container flashed-messages">
        <div class="row">
            <div class="col-md-12" id="flash-list"></div>
        </div>
    </div>
    <!-- end message block -->
    <div class="center">
        {% for s, offence_lists in matched_offences %}
        {% for mid, extra_measure, ol in offence_lists %}
        <input type="text" id="match_id" value="{{mid}}" hidden="true">
        <form method="post" class="form" role="form" id="form_{{mid}}" enctype=multipart/form-data>
            <span class="label label-warning">Leerling : </span>&nbsp;{{s.first_name}} {{s.last_name}}
            <span class="label label-warning">Klas : </span>&nbsp;{{s.classgroup.name}}
            <table cellspacing="0" class="table table-striped table-bordered " width="100%" ,
                   style="margin-bottom:2px;">
                <thead>
                <tr>
                    <th>Datum</th>
                    <th>Leerkracht</th>
                    <th>Les</th>
                    <th>Opmerking</th>
                    <th>Maatregel</th>
                </tr>
                </thead>
                {% for o in ol %}
                <input type="text" name="offence_id" value="{{o.id}}" hidden="true">
                <tr>
                    <td>{{o.print_date}}</td>
                    <td>{{o.teacher.code}}</td>
                    <td>{{o.lesson.name}}</td>
                    <td>{{o.print_types}}</td>
                    <td>{{o.print_measures}}</td>
                </tr>
                {% endfor %}
            </table>
            <div class="btn-group" role="group" aria-label="...">
                <a class="btn btn-default" id="btn_match_reviewed_{{mid}}" onclick="match_reviewed('{{mid}}')">Controle afronden</a>
                <a class="btn btn-default" id="btn_extra_measure_{{mid}}" onclick="extra_measure('{{mid}}')">Extra sanctie</a>
                <a class="btn btn-default" id="btn_delete_extra_measure_{{mid}}"  onclick="delete_measure('{{mid}}')">Verwijder sanctie</a>
                <textarea rows="3" cols="40" id="txt_extra_measure_{{mid}}" readonly>{{extra_measure.note}}</textarea>
           </div>
            <br>
            <br>
        </form>

        {% endfor %}
        {% endfor %}

        <table cellspacing="0" class="table table-striped table-bordered " id="datatable" width="100%">
            <thead>
            <tr>
                <th><input type='checkbox' id="select_all"></th>
                <th>Datum</th>
                <th>Leerling</th>
                <th>LKR</th>
                <th>KL</th>
                <th>Les</th>
                <th>Opmerking</th>
                <th>Maatregel</th>
            </tr>
            </thead>
            {% for o in non_matched_offences%}
            <tr>
                <td><input type='checkbox' class='cb_all' name='cb' value='{{o.id}}'></td>
                <td>{{o.print_date}}</td>
                <td>{{o.student.last_name}} {{o.student.first_name}}</td>
                <td>{{o.teacher.code}}</td>
                <td>{{o.classgroup.name}}</td>
                <td>{{o.lesson.name}}</td>
                <td>{{o.print_types}}</td>
                <td>{{o.print_measures}}</td>

            </tr>
            {% endfor %}
        </table>


    </div>
    <!-- Modal (pop-up window) -->
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" id="dismiss_modal" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title" id="modal_title">Nieuwe sanctie</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="modal_extra_measure">Sanctie</label>
                        <textarea class="form-control" rows="5" id="modal_extra_measure" name="extra_measure"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="close_modal" type="button" class="btn btn-default" data-dismiss="modal">Bewaar</button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script type="text/javascript"> {% include "review/review.js" %}</script>
{% endblock %}
