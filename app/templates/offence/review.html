{% import "bootstrap/wtf.html" as wtf %}
{% import "bootstrap/utils.html" as utils %}
{% extends "base.html" %}


{% block content2 %}
<style>
.extra_measure {
    border-radius: 5px;
    border: 2px solid #f7c655;
    margin-left: 25px;
    padding: 5px;
}
</style>
<div class="content-section">
    <div class="center">
        {% if matched_offences %}
        {% for s, offence_lists in matched_offences %}
        {% for mid, extra_measure, ol in offence_lists %}
        <input type="text" id="match_id" value="{{mid}}" hidden="true">
        <form method="post" class="form" role="form" id="form_{{mid}}" enctype=multipart/form-data>
            <span class="label label-warning">Leerling : </span>&nbsp;{{s.first_name}} {{s.last_name}}
            <span class="label label-warning">Klas : </span>&nbsp;{{s.classgroup.name}}
            <table cellspacing="0" class="table table-striped table-bordered " width="100%" ,
                   style="margin-bottom:2px;">
                <thead>
                <tr>
                    <th>Datum</th>
                    <th>Leerkracht</th>
                    <th>Les</th>
                    <th>Opmerking</th>
                    <th>Maatregel</th>
                </tr>
                </thead>
                {% for o in ol %}
                <input type="text" name="offence_id" value="{{o.id}}" hidden="true">
                <tr>
                    <td>{{o.print_date}}</td>
                    <td>{{o.teacher.code}}</td>
                    <td>{{o.lesson.name}}</td>
                    <td>{{o.print_types}}</td>
                    <td>{{o.print_measures}}</td>
                </tr>
                {% endfor %}
            </table>
            <div class="flex-container">
                {% if extra_measure.note == "" %}
                <div class="btn btn-default default-hidden" id="btn_match_reviewed_{{mid}}"
                   onclick="match_reviewed('{{mid}}')">Controle afronden</div>
                <div class="btn btn-default" id="btn_extra_measure_{{mid}}" onclick="extra_measure('{{mid}}')">
                    Extra sanctie</div>
                <div class="btn btn-default default-hidden" id="btn_delete_extra_measure_{{mid}}"
                   onclick="delete_measure('{{mid}}')">Verwijder sanctie</div>
                <div class="extra_measure default-hidden" id="txt_extra_measure_{{mid}}"></div>
                {% else %}
                <div class="btn btn-default default-hidden" id="btn_match_reviewed_{{mid}}"
                   onclick="match_reviewed('{{mid}}')">Controle afronden</div>
                <div class="btn btn-default default-hidden" id="btn_extra_measure_{{mid}}" onclick="extra_measure('{{mid}}')">
                    Extra sanctie</div>
                <div class="btn btn-default" id="btn_delete_extra_measure_{{mid}}"
                   onclick="delete_measure('{{mid}}')">Verwijder sanctie</div>
                <div class="extra_measure" id="txt_extra_measure_{{mid}}">{{extra_measure.note}}</div>
                {% endif %}
            </div>
        </form>
<br>
        {% endfor %}
        {% endfor %}
        <br>
        <form method="post" class="form" id="form_review_done" action="{{url_for('offences.review_done')}}" enctype=multipart/form-data>
            <input type="text" hidden name="schoolyear" value="{{selected_schoolyear}}">
            <hr style="border-top: 10px solid #d1dc9c; margin-top: -5px; margin-bottom: 10px;"/>
            <div class="btn btn-default" id="btn_review_done" onclick="review_done()">Controle afronden</div>
        </form>
        {% else %}
        <h1>Er zijn geen leerlingen die gecontroleerd moeten worden</h1>
        <a class="btn btn-default" href="{{ url_for('offences.show') }}">Terugkeren</a>
        {% endif %}
        {% if false %}
        <br>
        <br>
        <table cellspacing="0" class="table table-striped table-bordered " id="datatable" width="100%">
            <thead>
            <tr>
                <th><input type='checkbox' id="select_all"></th>
                <th>Datum</th>
                <th>Leerling</th>
                <th>LKR</th>
                <th>KL</th>
                <th>Les</th>
                <th>Opmerking</th>
                <th>Maatregel</th>
            </tr>
            </thead>
            {% for o in non_matched_offences%}
            <tr>
                <td><input type='checkbox' class='cb_all' name='cb' value='{{o.id}}'></td>
                <td>{{o.print_date}}</td>
                <td>{{o.student.last_name}} {{o.student.first_name}}</td>
                <td>{{o.teacher.code}}</td>
                <td>{{o.classgroup.name}}</td>
                <td>{{o.lesson.name}}</td>
                <td>{{o.print_types}}</td>
                <td>{{o.print_measures}}</td>

            </tr>
            {% endfor %}
        </table>
        {% endif %}
    </div>
    <!-- Modal (pop-up window) -->
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" id="dismiss_modal" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title" id="modal_title">Nieuwe sanctie</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="modal_extra_measure">Sanctie</label>
                        <input type="text" class="form-control" id="modal_extra_measure" name="extra_measure">
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="close_modal" type="button" class="btn btn-default" data-dismiss="modal">Bewaar</button>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
{{ super() }}
<script type="text/javascript"> {% include "offence/review.js" %}</script>
{% endblock %}
